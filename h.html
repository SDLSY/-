<!DOCTYPE html>
<html>
<head>
    <title>网页题排行榜</title>
    <link rel="stylesheet" href="decorat.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
    $(document).ready(function() {
        $.getJSON("https://puzzle.qieee.top/api/rank", function(data) {
            var i = 0;
            var table = $("<table></table>");
            var headerRow = $("<tr></tr>");
            headerRow.append("<th>RANK</th>")
            headerRow.append("<th>Name</th>");
            headerRow.append("<th>ID</th>");
            headerRow.append("<th>Level 0 Score</th>");
            headerRow.append("<th>Level 1 Score</th>");
            headerRow.append("<th>Level 2 Score</th>");
            headerRow.append("<th>Level 3 Score</th>");
            headerRow.append("<th>Total Score</th>");
            table.append(headerRow);
            $.each(data, function(index, item) {
                var sum = 0;
                var firstPassIndex = -1;
                $.each(item.score, function(index, score) {
                    sum += score.score;
                    if (score.score === 10 && firstPassIndex === -1) {
                        firstPassIndex = index;
                    }
                });
                item.sum_score = sum;
                item.first_pass_index = firstPassIndex;
            });
            data.sort(function(a, b) {
                return b.sum_score - a.sum_score;
            });
            $.each(data, function(index, item) {
                i++;
                var row = $("<tr></tr>");
                row.append("<td>" + i + "</td>")
                row.append("<td>" + item.name + "</td>");
                row.append("<td>" + item.id + "</td>");
                $.each(item.score, function(index, score) {
                    var cellClass = score.score === 10 ? "score-cell-pass" : "score-cell-fail";
                    if (index === item.first_pass_index) {
                        cellClass += " first-pass";
                    }
                    row.append("<td class='" + cellClass + "'>" + score.score + "</td>");
                });
                row.append("<td class='sum-score-cell'>" + item.sum_score + "</td>")
                table.append(row);
            });
            $("#table-container").append(table);
        });
    });
    </script>
    <style>
    .score-cell-pass {
        color: green;
    }
    .score-cell-fail {
        color: red;
    }
    .first-pass {
        background-color: darkgreen;
        color: white;
    }
    .sum-score-cell {
        color: red;
        font-weight: bold;
    }
    </style>
</head>
<body>
    <h1>网页题排行榜</h1>
    <table style="table-layout: auto;" id="table-container">
        <thead></thead>
        <tbody id="getinformation" style="text-align: center;"></tbody>
    </table>
</body>
</html>